---
layout: post
title: Pthreads共享内存编程
tags: 多线程&并发
categories: 技术文章
---

## 1 进程、线程和Pthreads

### 1.1 进程与线程的区别

在计算机科学中，**进程**和**线程**是两个基本的执行单元，它们在多任务操作系统中扮演着重要的角色。理解它们之间的区别对于编写高效的并发程序至关重要。

#### 进程（Process）

进程可以被视为一个程序的运行实例。它是系统资源分配和调度的基本单位，拥有独立的地址空间和资源。一个进程可以包含多个线程，它们共享进程的资源，但是进程之间的资源是隔离的。在操作系统中，比如Windows，一个运行的应用程序，如`xx.exe`，就是一个进程[1](https://blog.csdn.net/ThinkWon/article/details/102021274)。

#### 线程（Thread）

线程是进程中的一个执行路径，是CPU调度和执行的最小单位。它们共享其母进程的资源，如内存和文件句柄，但每个线程拥有自己的程序计数器（PC）、虚拟机栈和本地方法栈。这使得线程在执行时能够更高效地进行上下文切换。线程有时被称为轻量级进程[1](https://blog.csdn.net/ThinkWon/article/details/102021274)。

#### 主要区别

- **资源分配**：进程是资源分配的独立单位，拥有独立的内存空间，而线程是CPU调度的基本单位，共享其母进程的资源。
- **开销**：进程间切换的开销较大，因为它们拥有独立的地址空间。线程间切换的开销较小，因为它们共享相同的地址空间和资源。
- **通信**：进程间通信（IPC）需要特定的机制，如管道、信号量或共享内存，而线程可以直接通过读写共享数据来通信。
- **独立性**：一个进程崩溃不会影响其他进程，但一个线程崩溃可能会导致整个进程崩溃。
- **多任务**：多线程可以在单个进程中实现真正的并行工作，而多进程则涉及到进程间的协调和资源共享。

#### 从JVM角度

在Java虚拟机（JVM）中，线程是执行字节码的实体。每个线程都有自己的程序计数器和栈，但是堆和方法区是由所有线程共享的。这意味着每个线程可以访问相同的对象和类定义，这是实现多线程程序的关键[1](https://blog.csdn.net/ThinkWon/article/details/102021274)。

#### 多进程与多线程

多进程模型中，每个进程运行独立的任务，它们之间相互隔离。多线程模型中，线程共享同一进程的资源，可以更高效地进行通信和数据共享。但是，多线程程序的健壮性通常低于多进程程序，因为一个线程的失败可能会影响整个进程[1](https://blog.csdn.net/ThinkWon/article/details/102021274)。

#### 结论

在设计软件时，选择使用多进程还是多线程取决于应用程序的需求。如果需要隔离和资源独立性，多进程可能是更好的选择。如果需要高效的资源共享和通信，多线程可能更合适。

### 1.2 Pthreads

Pthreads是一个多线程C库。
